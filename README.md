# Self-Healing Infrastructure Demo

This project demonstrates automated service recovery using Prometheus, Alertmanager, and Ansible.

## ðŸ”§ Components

- **NGINX:** Sample service to monitor
- **Prometheus:** Monitors service uptime
- **Alertmanager:** Sends webhook when alert fires
- **Webhook Server:** Triggers Ansible on alert
- **Ansible:** Restarts NGINX

## ðŸš€ How it works

1. Prometheus monitors NGINX via metrics exporter
2. If NGINX goes down, alert triggers in 30s
3. Alertmanager sends webhook to Python server
4. Python server runs Ansible playbook
5. Ansible restarts the NGINX service

## ðŸ§ª Testing

- Stop NGINX: `sudo systemctl stop nginx`
- Watch logs: `tail -f logs/webhook.log`
- Confirm NGINX is restarted automatically

## ðŸ“¦ File Structure

```
self-healing-infra/
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ prometheus.yml                  # Prometheus configuration file
â”‚   â””â”€â”€ alertmanager.yml                # Alertmanager configuration file
â”‚
â”œâ”€â”€ nginx/
â”‚   â””â”€â”€ nginx.conf                      # NGINX configuration (stub_status enabled)
â”‚
â”œâ”€â”€ webhook/
â”‚   â”œâ”€â”€ webhook-server.py              # Flask app acting as Alertmanager webhook receiver
â”‚   â”œâ”€â”€ requirements.txt               # Python dependencies
â”‚   â””â”€â”€ Dockerfile                     # Dockerfile for webhook server
â”‚
â”œâ”€â”€ ansible/
â”‚   â””â”€â”€ restart-nginx.yml              # Ansible playbook to restart NGINX
â”‚
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ nginx_prometheus_exporter.sh   # (Optional) Custom script to start exporter
â”‚
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ webhook.log                    # Logs generated by webhook server
â”‚
â”œâ”€â”€ docker-compose.yml                 # Docker Compose file to spin up everything
â””â”€â”€ README.md                          # Optional: Docs/instructions
```